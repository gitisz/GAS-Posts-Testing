<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GAS Post Testing</title>
</head>
<body>
    <form id="form-upload-images">
        <div id="upload-images" class="d-none member-access">
            <div class="header">
                <span class="material-symbols-outlined icon">
                    file_upload
                </span>
                <span class="text">Add Submissions</span>
            </div>

            <div id="upload-gallery" class="d-none">
                <h3 class="fs-6">Images Uploaded</h3>
                <ul class="gallery">
                    <li>
                        <span>Image Placeholder</span>
                        <span class="saved d-none">Saved</span>
                    </li>
                    <li>
                        <span>Image Placeholder</span>
                        <span class="saved d-none">Saved</span>
                    </li>
                    <li>
                        <span>Image Placeholder</span>
                        <span class="saved d-none">Saved</span>
                    </li>
                    <li>
                        <span>Image Placeholder</span>
                        <span class="saved d-none">Saved</span>
                    </li>
                </ul>
            </div>
            <div class="mb-3">
                <div class="banner">
                    <label for="formFile" class="form-label"
                        >You can submit up to
                        <span id="max-entries" class="fw-bold text-warning">fetching...</span>
                        images</label>
                    <input class="form-control" type="file" id="formFile" />
                </div>

                <div id="image-details" class="d-none">
                    <div class="row mb-3 mt-2">
                        <label
                            for="worktitle"
                            class="col-md-1 col-form-label"
                            >Title</label>
                        <div class="col-md-11">
                            <input
                                type="text"
                                name="worktitle"
                                id="worktitle"
                                class="form-control"
                            />
                        </div>
                    </div>
                    <div class="row mb-3 mt-2">
                        <label
                            for="width"
                            class="col-md-1 col-form-label"
                        >
                            Width (in)
                        </label>
                        <div class="col-md-2">
                            <input
                                type="text"
                                name="width"
                                id="width"
                                class="form-control"
                            />
                        </div>
                        <label
                            for="height"
                            class="col-md-1 col-form-label"
                        >
                            Height (in)
                        </label>
                        <div class="col-md-2">
                            <input
                                type="text"
                                name="height"
                                id="height"
                                class="form-control"
                            />
                        </div>
                        <label
                            for="medium"
                            class="col-md-1 col-form-label"
                        >
                            Medium
                        </label>
                        <div class="col-md-5">
                            <input
                                type="text"
                                name="medium"
                                id="medium"
                                class="form-control"
                            />
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label
                            for="price"
                            class="col-md-1 col-form-label mt-2"
                        >
                            Price $
                        </label>
                        <div class="col-md-2 mt-2">
                            <input
                                type="text"
                                name="price"
                                id="price"
                                class="form-control"
                            />
                        </div>
                        <div class="col-auto mt-2">
                            <button type="submit" class="btn btn-primary">
                                Submit Work
                            </button>
                        </div>
                        <div class="col-auto col-form-label mt-2">
                            <span class="label">Total Fee: </span>
                            <span id="totalFee" class="text-muted"
                                >Calculating ...</span
                            >
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </form>

    <script>
        const form = document.getElementById("form-upload-images")
        const url = "https://script.google.com/macros/s/AKfycbxoMQ1JDHbHLwlc11iY86E62bEp1lzgsTXaCOg15YyLuKNHfhz0is4ngQLaa0EXo0sf/exec"
        form.addEventListener('submit', function(e) {
            e.preventDefault()
            const formdata = new FormData(this)
            const payload = [ 
                ['eventid', 'CABE37'],
                ['eventtitle', 'Test Event'],
                ['firstname', 'James'],
                ['lastname', 'Green'],
                ['email', 'jamesgreen.311@gmail.com'],
                ['phone', '804-516-1379'],
                ...formdata
            ]
            let _data = {}
            for (const [key, value] of payload) {
                _data[key] = value
                console.log(`${key}: ${value} \n`)
            }
/*             console.log(_data)
            const data = {
                'eventid' : 'CABE38'
            } */
            fetch(url, {
                method: "POST",
                mode: "no-cors",
                cache: 'no-cache',
                credentials: 'omit',
                headers: {
                    'Content-Type': 'application/json'
                },

                body: JSON.stringify(_data)
/*                 mode: 'cors',
                cache: 'no-cache',
                credentials: 'same-origin',
                body: payload,
                headers: {
                    'Content-Type': 'application/json'
                } */

            })
            .then(res => res.json())
            .then(data => console.log(data))
            .catch(err => console.log(err))
        })
    </script>
</body>
</html>